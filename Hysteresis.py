import pandas as pd
import matplotlib.pyplot as plt
from scipy.signal import resample
import numpy as np

# Load the two CSV files
file_4n_path = '/mnt/data/4N.csv'
file_x2_z1_path = '/mnt/data/x2_z1.csv'

# Load the 4N.csv file and the x2_z1.csv file
df_4n = pd.read_csv(file_4n_path)
df_x2_z1 = pd.read_csv(file_x2_z1_path)

# Rename columns for clarity in x2_z1 file
df_x2_z1.columns = ["Index", "Timestamp"]

# Now, filter the 4N data based on the timestamps in df_x2_z1
df_filtered_4n = df_4n[df_4n['Timestamp'].isin(df_x2_z1['Timestamp'])]

# We only need the F_z values from the filtered data
f_z_values = df_filtered_4n['Fz'].values

# Euclidean distances from the user's provided data
euclidean_distances = [
    9127.636021023858, 8482.530912936836, 8506.829607176152, 8706.189976648435,
    8706.189976648435, 8706.189976648435, 8314.996239876014, 8314.996239876014,
    8314.996239876014, 8314.996239876014, 8314.996239876014, 9418.851814720618,
    9512.812629715569, 9512.812629715569, 9512.812629715569, 9512.812629715569,
    9512.812629715569, 9512.812629715569, 9512.812629715569, 9512.812629715569,
    9512.812629715569, 9923.829245060915, 11089.418137739147, 9927.363622876524,
    10332.16429278598, 11077.674747806741, 10485.630789464147, 10394.529930789748,
    10172.851140562449, 10387.564079229574, 10226.666474262642, 10836.330744663619,
    10183.014647331478, 10705.041395146074, 10155.007656770078, 11146.972872480452,
    10227.044343448453, 11072.86225943359, 10330.861930077943, 10831.207421336598,
    10596.460259319436, 10578.725426761475, 10935.602750015987, 11216.628146832063,
    10597.708687882374, 11356.780014187743, 10473.539955272145, 10663.304800626052,
    9895.673952071778, 10440.37329728721, 10673.569315649847, 10684.083128913264,
    12074.47153105734, 10895.917026837991, 11014.803401173154, 11368.040247897854,
    11591.902099881741, 13368.841858472266, 12661.606278621031, 12707.375567327903,
    14083.635060168039, 14545.971461305478, 14610.443298295637, 15931.302086669204,
    16149.069038452093, 16454.952672709787, 17245.620694425106, 17912.867150750702,
    17834.155466129032, 18596.40023290885, 19744.641672817394, 18031.392023090233,
    20243.532331554594, 19553.03688922015, 21460.458936516592, 21896.892794613963,
    22688.244881895873, 23019.35632089107, 23486.163340356004, 24439.3343805152,
    25582.668923631656, 25865.34883469448, 26303.127037584905, 26856.91397636196,
    27740.718516203357, 28676.56514153678, 28330.737913792334, 27775.29798051656,
    28978.382407468664, 27406.995116267644, 27652.33907509265, 25060.238572256225,
    25366.767203103947, 23851.696079842615, 23756.085439578863, 22799.755961228046,
    22731.336481609163, 21725.604864568573, 21606.89374832754, 21074.439130055773,
    19165.342576200554, 18987.221514131223, 17771.11115380196, 19207.41559651824,
    17175.290417420943, 16476.557038334664, 16583.874179752394, 16407.88512252028,
    14787.66713354328, 15263.468571182331, 14659.626910934834, 13208.746053308521,
    13125.29579867992, 12649.729399912618, 12389.276125074266, 11521.818176115217,
    11905.407788129853, 11889.230743901771, 10912.040989576417, 11598.509083132056,
    11586.297227467341, 10750.718654939763, 11024.321749036848, 11011.391513660143,
    10662.74119352072, 10610.839458288663, 10430.440778513093, 11322.587735894353,
    10747.351658855077, 11229.241149293179, 10882.881316609832, 9702.161089745594,
    10468.91896419967, 10643.584447184565, 11430.711282811653, 11671.0374265604,
    10293.076330191116, 10558.946454246829, 11056.08160457309, 10022.216583834854,
    11326.804595373722, 10781.607293429359, 11237.292354171126, 11434.135625504803,
    11405.206373344427, 10436.388889124139, 10628.26771563176, 10454.725755151461,
    11204.3608211435, 10821.313609539446, 11931.05968400581, 10891.706827543023,
    10850.069273575646, 10811.947103973023, 11281.846126104616, 11233.684408643972,
    9409.84192521521, 10204.73575273661, 11222.52617855512, 11247.3644459525,
    9847.291919625779, 10770.722740087913, 10640.92489362779
]

# Plot the F_z values (x-axis) vs Euclidean distances (y-axis)
plt.figure(figsize=(10, 6))
plt.plot(f_z_values, euclidean_distances[:len(f_z_values)], marker='o', linestyle='-', color='b')
plt.xlabel("F_z Values")
plt.ylabel("Euclidean Distance")
plt.title("F_z vs Total Euclidean Distance")
plt.grid(True)
plt.show()

# Now, we filter the data between the specified timestamps
start_timestamp = 1725813199284940
end_timestamp = 1725813217309450

df_filtered_new_4n = df_4n[(df_4n['Timestamp'] >= start_timestamp) & (df_4n['Timestamp'] <= end_timestamp)]

# Resample the Fz data to 165 points
f_z_resampled, indices = resample(df_filtered_new_4n['Fz'], 165, t=df_filtered_new_4n.index, window=None)

# Convert all negative values in f_z_resampled to positive
f_z_resampled_positive = abs(f_z_resampled)

# Plot the resampled F_z values
plt.figure(figsize=(10, 6))
plt.plot(f_z_resampled_positive, marker='o', linestyle='-', color='purple')
plt.xlabel("Index")
plt.ylabel("Resampled Positive F_z Values")
plt.title(f"Resampled Positive F_z Values (165 Points
